import Image from '/src/components/Image';
import ResourceTable from '/src/components/ResourceTable';
import Video from '/src/components/Video';
import { Var, VarLink } from '/src/components/content/var';

Zerops automatically scales your <Var name="serviceDisplay" /> service based on actual usage. When your application needs more power, resources increase. When demand drops, resources scale down to reduce costs.

:::tip Read More
For complete scaling details across all services, see [Automatic Scaling and High Availability](/features/scaling-ha).
:::

## How it works

**Vertical scaling** adds more CPU, RAM, or disk space to existing containers. This approach is applied first because it is faster and more efficient.

**Horizontal scaling** creates entirely new containers when vertical scaling reaches its configured limits.

:::info Read More
Learn more about [vertical](/features/scaling-ha#part-1-resource-management) and [horizontal scaling](/features/scaling-ha#part-2-container-architecture--service-specific-approaches) and [complete technical details](/features/scaling-ha#resource-scaling-behavior) in our scaling guide.
:::

## Configure scaling

You can configure scaling settings at different stages:

- **During service creation** - Set initial scaling parameters when <VarLink name="servicePath" path="/{{VAR}}/how-to/create">creating</VarLink> your <Var name="serviceDisplay" /> service in the Zerops GUI.

- **During import** - Define scaling configuration in your YAML import file using the `verticalAutoscaling` and horizontal scaling parameters. See [Import & Export YAML Configuration](/references/import) for complete syntax.

- **After service creation** - Navigate to your <Var name="serviceDisplay" /> service and select **Automatic scaling configuration** from the menu to modify settings.

<figure style={{ textAlign: 'center', margin: '1rem 0' }}>
  <Image
    lightImage="/img/gui/automatic-scaling.webp"
    darkImage="/img/gui/automatic-scaling.webp"
    alt="Automatic Scaling"
    style={{ width: '95%', height: 'auto' }}
  />
</figure>

### CPU Settings

**CPU mode**: Choose between shared (cost-effective, variable performance) or dedicated (consistent performance, higher cost). You can change CPU mode once per hour. See [pricing](https://zerops.io/#pricing) for costs or read more about [CPU mode](/features/scaling-ha#cpu-mode).

**Minimum and Maximum CPU**: Configure the boundaries for CPU core allocation. Zerops will scale CPU resources within these limits based on actual usage.

<table>
  <tbody>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Minimum CPU cores</td>
      <td className="w-fit my-1.5">1</td>
    </tr>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Maximum CPU cores</td>
      <td className="w-fit my-1.5">8</td>
    </tr>
  </tbody>
</table>

:::tip
Set minimum = maximum to disable automatic CPU scaling.
:::

**Start CPU cores**: Determines how many CPU cores are allocated during application startup. Increase this value if your <Var name="serviceDisplay" /> application starts slowly or requires more processing power during initialization.
- Default: 2 cores

**CPU Scaling Thresholds** (for dedicated CPU mode only):
- **Min free CPU %**: Triggers scaling when free CPU drops below this percentage of a single core
- **Dynamic free total %**: Triggers scaling when total free CPU across all cores drops below this percentage

:::info Read More
More details on [CPU Settings](/features/scaling-ha#cpu-settings).
:::

### RAM Settings

**Minimum and Maximum RAM**: Configure the boundaries for RAM allocation. Zerops will scale RAM within these limits based on actual usage.

<table>
  <tbody>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Minimum RAM</td>
      <td className="w-fit my-1.5">0.125 GB</td>
    </tr>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Maximum RAM</td>
      <td className="w-fit my-1.5">48 GB</td>
    </tr>
  </tbody>
</table>

:::tip
Set minimum = maximum to disable automatic RAM scaling.
:::

**RAM Scaling Thresholds**: Help prevent out-of-memory crashes by maintaining buffer space:
- **Absolute (GB)**: Maintains this amount of free RAM at all times
- **Percentage**: Keeps this percentage of total RAM free

Consider increasing these values if your application experiences memory-related crashes.

:::info Read More
More details on [RAM Settings](/features/scaling-ha#ram-settings).
:::

<Video
  width="90%"
  autoplay="true"
  loop="loop"
  muted="muted"
  preload="none"
  src="/vids/ram-scaling.webm"
  plays-inline="true"
/>

### Disk Settings

**Minimum and Maximum Disk**: Configure the boundaries for disk space allocation. Zerops will scale disk space within these limits based on actual usage.

<table>
  <tbody>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Minimum disk</td>
      <td className="w-fit my-1.5">1 GB</td>
    </tr>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Maximum disk</td>
      <td className="w-fit my-1.5">250 GB</td>
    </tr>
  </tbody>
</table>

:::tip
Set minimum = maximum to disable automatic disk scaling.
:::

:::info Read More
More details on [Disk Settings](/features/scaling-ha#disk-settings).
:::

### Container Settings

**Container limits**: Set how many containers your <Var name="serviceDisplay" /> service can scale to:

<table>
  <tbody>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Minimum containers</td>
      <td className="w-fit my-1.5">1</td>
    </tr>
    <tr>
      <td className="w-fit my-1.5 font-semibold whitespace-nowrap">Maximum containers</td>
      <td className="w-fit my-1.5">10</td>
    </tr>
  </tbody>
</table>

**Single container** (maximum = 1): More cost-effective, but your application will experience downtime if the container fails. This mode is suitable for development and testing environments.

**Multiple containers** (maximum > 1): Can provide high availability for production environments, but only if your <Var name="serviceDisplay" /> application is properly designed for it. Each container runs on a different physical server for redundancy. Your application must be stateless and avoid storing data in local files to work properly across multiple containers.

:::info Read More
More details on [Horizontal Scaling](/features/scaling-ha#horizontal-scaling-runtime-services-linux-containers-and-docker).
:::

## Monitor usage

Navigate to your service and select **Service dashboard & runtime containers** to view:
- CPU, RAM, and disk usage over time
- Number of active containers
- Historical scaling events

:::info Read More
Learn about [monitoring your infrastructure](/features/scaling-ha#monitoring-your-infrastructure) in detail.
:::

## Common issues

**Out of memory crashes**
- Increase the minimum free RAM settings in your scaling configuration
- Review your code for potential memory leaks

**Higher than expected costs**
- Consider lowering your maximum resource limits

**Application issues with multiple containers**
- Remove dependencies on local file storage (use external storage services instead)
- Implement session management that works across containers (consider using Redis or external session stores)
- Ensure your application is designed to be stateless

**Slow application startup**
- Increase the "Start CPU cores" setting in your scaling configuration
- Consider switching to dedicated CPU mode for more consistent performance

:::info Read More
More troubleshooting tips: [Scaling Troubleshooting](/features/scaling-ha#troubleshooting).
:::

*Have questions? Join our [Discord community](https://discord.gg/zerops) for help!*