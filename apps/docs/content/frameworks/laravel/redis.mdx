---
title: Using Redis with Laravel
description: Learn how to configure and use Redis for caching, queues, and sessions in your Laravel application on Zerops
---

import Image from '/src/components/Image';

# Redis Integration with Laravel

Redis is a powerful in-memory data structure store that can be used as a database, cache, message broker, and queue. This guide will help you integrate Redis with your Laravel application on Zerops, enabling high-performance caching, session management, and queue processing.

## Adding Redis Service

Redis needs to be added as a service to your Zerops project before you can use it with Laravel. The service configuration defines the Redis version, availability mode, and other essential settings.

```yml
services:
  - hostname: redis
    type: valkey@7.2
    mode: NON_HA  # or HA for high availability
    priority: 10
```

You can also add Valkey Redis service to your project manually from the Zerops GUI.

<Image
  lightImage="/img/gui/valkey/service.webp"
  darkImage="/img/gui/valkey/service.webp"
  alt="Add a new service"
  style={{ width: '95%', height: 'auto' }}
/>

:::tip High Availability Mode
For production environments, it's recommended to use `HA` mode. This ensures automatic failover in case of node failure and provides data replication across multiple nodes. High availability mode significantly improves reliability and uptime while offering better handling of network partitions.
:::

## Environment Configuration

### Basic Redis Settings

The environment variables configure how your Laravel application connects to and utilizes Redis. These settings control various aspects of Redis integration, from basic connectivity to specific feature configurations.

```yml
zerops:
  - setup: app
    build:
      base:
        - php@8.4
      os: alpine
    run:
      base: php-nginx@8.4
      os: alpine
      siteConfigPath: site.conf.tmpl
      envVariables:
        # Redis Connection Settings
        REDIS_CLIENT: phpredis    # PHP Redis client for better performance
        REDIS_HOST: redis        # Internal hostname of Redis service
        REDIS_PORT: 6379         # Standard Redis port number

        # Cache Configuration
        CACHE_PREFIX: cache      # Namespace for cache keys
        CACHE_STORE: redis       # Use Redis as primary cache

        # Session Configuration
        SESSION_DRIVER: redis    # Store sessions in Redis
        SESSION_ENCRYPT: false   # Disable session encryption
        SESSION_LIFETIME: 120    # Session timeout in minutes
        SESSION_PATH: /          # Cookie path setting

        # Queue Configuration
        QUEUE_CONNECTION: redis  # Use Redis for job queues
        BROADCAST_CONNECTION: redis  # Redis for event broadcasting
```

## Feature-Specific Configuration

### Redis Caching

Laravel's cache system provides a unified API across various cache backends. This configuration sets up Redis as your application's primary cache store, enabling fast and reliable data caching. You can also set up a custom cache connection in the `config/cache.php` file.

```php
'default' => env('CACHE_STORE', 'database'),

'stores' => [
    'redis' => [
        'driver' => 'redis',
        'connection' => env('REDIS_CACHE_CONNECTION', 'cache'),
        'lock_connection' => env('REDIS_CACHE_LOCK_CONNECTION', 'default'),
    ],
],

'prefix' => env('CACHE_PREFIX', Str::slug(env('APP_NAME', 'laravel'), '_').'_cache_'),
```

### Session Management with Redis

Using Redis for session storage provides better performance than file-based sessions and enables seamless session sharing across multiple application servers. You can also set up a custom session connection in the `config/session.php` file.

```php
'driver' => env('SESSION_DRIVER', 'redis'),
'lifetime' => env('SESSION_LIFETIME', 120),
'encrypt' => env('SESSION_ENCRYPT', false),
```

### Queue System Configuration

Redis queues offer a robust solution for handling background jobs in Laravel. This configuration sets up Redis as your queue backend with retry policies and connection settings. You can also set up a custom queue connection in the `config/queue.php` file.

```php
'default' => env('QUEUE_CONNECTION', 'redis'),

'connections' => [
    'redis' => [
        'driver' => 'redis',
        'connection' => 'default',
        'queue' => 'default',
        'retry_after' => 90,     // Retry failed jobs after 90 seconds
        'block_for' => null,     // Don't block when no jobs available
    ],
],
```

## Working with Redis Features

### Cache Operations Examples
```php
// Store items in cache with expiration time
Cache::put('key', 'value', $seconds);

// Retrieve cached items with optional default value
$value = Cache::get('key');

// Store items indefinitely until manually removed
Cache::forever('key', 'value');
```

### Queue Processing Examples
```php
// Dispatch a job to the Redis queue with specific connection
ProcessPodcast::dispatch($podcast)->onConnection('redis');

// Start the queue worker process for Redis
php artisan queue:work redis
```

### Session Handling Examples
```php
// Store data in the Redis session
session(['key' => 'value']);

// Retrieve data from the session with optional default
$value = session('key');
```
