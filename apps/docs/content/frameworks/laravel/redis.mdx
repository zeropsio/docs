---
title: Using Redis with Laravel
description: Learn how to configure and use Redis for caching, queues, and sessions in your Laravel application on Zerops
---

import Image from '/src/components/Image';

## Adding Redis Service

Add Redis (ValKey) service to your Zerops project by including it in your import configuration:

```yml
services:
  - hostname: redis
    type: valkey@7.2
    mode: NON_HA  # or HA for high availability
    priority: 10
```

:::tip
Use `HA` mode for production environments to ensure high availability and automatic failover.
:::

## Environment Variables

Configure your Laravel service to use Redis by adding these environment variables in your `zerops.yml`:

```yml
zerops:
  - setup: app
    run:
      envVariables:
        # Redis Connection
        REDIS_CLIENT: phpredis
        REDIS_HOST: redis
        REDIS_PORT: 6379

        # Cache Configuration
        CACHE_PREFIX: cache
        CACHE_STORE: redis

        # Session Configuration
        SESSION_DRIVER: redis
        SESSION_ENCRYPT: false
        SESSION_LIFETIME: 120
        SESSION_PATH: /

        # Queue Configuration
        QUEUE_CONNECTION: redis
        BROADCAST_CONNECTION: redis
```

## Features Configuration

### Caching

Configure Redis as your cache driver in `config/cache.php`:

```php:config/cache.php
'default' => env('CACHE_STORE', 'database'),

'stores' => [
    'redis' => [
        'driver' => 'redis',
        'connection' => env('REDIS_CACHE_CONNECTION', 'cache'),
        'lock_connection' => env('REDIS_CACHE_LOCK_CONNECTION', 'default'),
    ],
],

'prefix' => env('CACHE_PREFIX', Str::slug(env('APP_NAME', 'laravel'), '_').'_cache_'),
```

### Session Management

Redis can handle your session storage. Configure in `config/session.php`:

```php:config/session.php
'driver' => env('SESSION_DRIVER', 'redis'),
'lifetime' => env('SESSION_LIFETIME', 120),
'encrypt' => env('SESSION_ENCRYPT', false),
```

### Queue System

Set up Redis for Laravel queues in `config/queue.php`:

```php:config/queue.php
'default' => env('QUEUE_CONNECTION', 'redis'),

'connections' => [
    'redis' => [
        'driver' => 'redis',
        'connection' => 'default',
        'queue' => 'default',
        'retry_after' => 90,
        'block_for' => null,
    ],
],
```

## Usage Examples

### Cache Operations
```php
// Store an item in cache
Cache::put('key', 'value', $seconds);

// Retrieve an item
$value = Cache::get('key');

// Store permanently
Cache::forever('key', 'value');
```

### Queue Processing
```php
// Dispatch a job
ProcessPodcast::dispatch($podcast)->onConnection('redis');

// Process queues
php artisan queue:work redis
```

### Session Handling
```php
// Store in session
session(['key' => 'value']);

// Get from session
$value = session('key');
```

:::tip Best Practices
- Use Redis for all caching in production
- Enable persistence for important data
- Monitor Redis memory usage
- Configure proper timeouts
- Use prefix to avoid key collisions
- Set up queue monitoring
:::