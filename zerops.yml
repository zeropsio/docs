zerops:
  - setup: docs
    build:
      os: ubuntu
      base: nodejs@20
      envVariables:
        URL: https://docs.zerops.io
        MEILISEARCH_HOST: https://docs-search.zerops.io
        MEILISEARCH_API_KEY: bfbc1c6fd31c47d525ce15f40af701d22b16a679baa99810c1a67a1f1d784731
        MEILISEARCH_INDEX_UID: docs
      buildCommands:
        - yarn
        - yarn prebuild
        - yarn build
      deployFiles:
        - apps/docs/build/~
    run:
      base: static
      initCommands:
        - sudo sed -i 's/^\(\s*text\/plain\s\+\)txt;$/\1txt md;/' /etc/nginx/mime.types
      routing:
        headers:
          - for: "~* \.md$*"
            values:
              Content-Disposition: '"inline" always'
              X-Content-Type-Options: '"nosniff"'
              X-Robots-Tag: '"googlebot: noindex, nofollow, bingbot: noindex, nofollow"'
              Cache-Control: '"public, max-age=3600, must-revalidate"'
          - for: "~* ^/.*/img/.*"
            values:
              X-Robots-Tag: '"googlebot: noindex, nofollow, bingbot: noindex, nofollow"'
              Cache-Control: '"public, max-age=86400, immutable"'

